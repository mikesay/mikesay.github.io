# 背景介绍 

## 应用架构 
刚开始数字化转型的企业由于没有什么遗留的包袱，基本上都会直接选择微服务架构，仅管服务的数量还不是很多，而技术栈基本上也是以Java和Spring Boot的组合为主。每个应用(服务)都有自己独立的Git仓库，通过持续集成流水线最终生成Docker镜像，再通过部署流水线部署并运行在基于Kubernetes的不同环境中。

## 应用的部署脚本 
我们选择Helm来定义模板化的部署资源文件。Helm的模板机制可以让我们把针对不同环境的配置参数化，同时Helm也提供了类似于编程语言的条件和循环以及类似于Linux的管道等功能，可以用来定义更复杂的部署资源文件产生的逻辑。 

## 运行环境的规划 
按照功能的不同，逻辑上把环境分成开发、测试、集成、预生产和生产五套环境。开发环境是面向开发人员的，通过持续集成流水线生成的Docker镜像会被自动部署在这个环境中，并执行一些重要的冒烟测试；开发环境成功部署后会自动触发测试环境的部署并执行更全面的自动化测试；集成环境的部署由测试工程师选择性的触发，用来发布通过测试环境且相对比较稳定的版本，供其它服务调用；预生产环境最接近生产环境，是应用上生产环境的最后一道关卡，通常会做一些性能和动态安全测试。物理上，开发、测试和集成环境运行在一个Kubernetes集群上，通过不同的命名空间隔离，而预生产和生产环境分别运行在不同的Kubernetes集群上，这两个集群的资源和配置基本上要保持一致，以保证通过预生产环境的应用,能够顺利的发布到生产环境。 

## CI/CD流水线工具 
选择Jenkins作为CI/CD流水线的建设工具。Jenkins是目前开源领域比较流行和成熟的一款CI/CD工具。随着Pipeline2.0的引进，可以通过编写代码的方式来创建CI/CD流水线，极大地提高了CI/CD流水线的开发效率，同时CI/CD流水线的代码也可以和应用代码一样在Git仓库中做版本管理。 
